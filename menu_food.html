<!-- ========================= menufood.html ========================= -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Link Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/menu_food.css"> 
  <title>Document</title>
</head>
<body>
    
</body>
</html>
<style>
    
</style>

<!-- ========================== HTML ========================== -->
<div class="app-layout">

    <!-- CỘT TRÁI: DANH SÁCH MÓN ĂN -->
    <div class="content-column p-3">
        <div class="container-fluid product-container">
            <div class="row" id="food-container">

                <!-- CARD 1 -->
                <div class="col-12 col-sm-5 col-md-4 col-lg-4 mb-4">
                    <div class="card shadow bg-white rounded-3 clickable-card menu-card d-flex h-100">
                        <div class="card-body d-flex flex-row flex-sm-column h-100 p-2 p-sm-3">
                            <div class="me-3 me-sm-0 mb-sm-3">
                                <img src="images/cuahap.jpg" alt="Cua hấp" class="rounded-3 card-img-responsive">
                            </div>
                            <div class="d-flex flex-column flex-grow-1 text-start text-sm-center">
                                <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-sm-center mt-sm-3">
                                    <h5 class="card-title mb-0">Cua hấp</h5>
                                    <p class="card-text text-primary fw-bold mb-0">90.000đ</p>
                                </div>
                                <div class="small text-muted pt-2 text-start text-sm-center d-none d-sm-block">Cua, sả, lá chanh</div>
                                <div class="d-flex justify-content-between align-items-center mt-auto pt-3">
                                    <i class="bi bi-star-fill me-2" style="color: #1d7de2;"> 5</i>
                                    <button data-product-id="1" type="button" class="btn btn-primary">Thêm món</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CARD 2 -->
                <div class="col-12 col-sm-5 col-md-4 col-lg-4 mb-4">
                    <div class="card shadow bg-white rounded-3 clickable-card menu-card d-flex h-100">
                        <div class="card-body d-flex flex-row flex-sm-column h-100 p-2 p-sm-3">
                            <div class="me-3 me-sm-0 mb-sm-3">
                                <img src="images/ghehap.jpg" alt="Ghẹ hấp" class="rounded-3 card-img-responsive">
                            </div>
                            <div class="d-flex flex-column flex-grow-1 text-start text-sm-center">
                                <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-sm-center mt-sm-3">
                                    <h5 class="card-title mb-0">Ghẹ hấp</h5>
                                    <p class="card-text text-primary fw-bold mb-0">80.000đ</p>
                                </div>
                                <div class="small text-muted pt-2 text-start text-sm-center d-none d-sm-block">Ghẹ, sả, lá chanh</div>
                                <div class="d-flex justify-content-between align-items-center mt-auto pt-3">
                                    <i class="bi bi-star-fill me-2" style="color: #1d7de2;"> 5</i>
                                    <button data-product-id="2" type="button" class="btn btn-primary">Thêm món</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CARD 3 -->
                <div class="col-12 col-sm-5 col-md-4 col-lg-4 mb-4">
                    <div class="card shadow bg-white rounded-3 clickable-card menu-card d-flex h-100" data-id="A3">
                        <div class="card-body d-flex flex-row flex-sm-column h-100 p-2 p-sm-3">
                            <div class="me-3 me-sm-0 mb-sm-3">
                                <img src="images/cahoiapchao.jpg" alt="Cá hồi áp chảo" class="rounded-3 card-img-responsive">
                            </div>
                            <div class="d-flex flex-column flex-grow-1 text-start text-sm-center">
                                <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-sm-center mt-sm-3">
                                    <h5 class="card-title mb-0">Cá hồi áp chảo</h5>
                                    <p class="card-text text-primary fw-bold mb-0">385.000đ</p>
                                </div>
                                <div class="small text-muted pt-2 text-start text-sm-center d-none d-sm-block">Cá hồi, tiêu, quế</div>
                                <div class="d-flex justify-content-between align-items-center mt-auto pt-3">
                                    <i class="bi bi-star-fill me-2" style="color: #1d7de2;"> 5</i>
                                    <button data-product-id="3" type="button" class="btn btn-primary">Thêm món</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CARD 4 -->
                <div class="col-12 col-sm-5 col-md-4 col-lg-4 mb-4">
                    <div class="card shadow bg-white rounded-3 clickable-card menu-card d-flex h-100">
                        <div class="card-body d-flex flex-row flex-sm-column h-100 p-2 p-sm-3">
                            <div class="me-3 me-sm-0 mb-sm-3">
                                <img src="images/cahoishashimi.jpg" alt="Sashimi cá hồi" class="rounded-3 card-img-responsive">
                            </div>
                            <div class="d-flex flex-column flex-grow-1 text-start text-sm-center">
                                <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-sm-center mt-sm-3">
                                    <h5 class="card-title mb-0">Sashimi cá hồi</h5>
                                    <p class="card-text text-primary fw-bold mb-0">170.000đ</p>
                                </div>
                                <div class="small text-muted pt-2 text-start text-sm-center d-none d-sm-block">Cá hồi tươi</div>
                                <div class="d-flex justify-content-between align-items-center mt-auto pt-3">
                                    <i class="bi bi-star-fill me-2" style="color: #1d7de2;"> 5</i>
                                    <button data-product-id="4" type="button" class="btn btn-primary">Thêm món</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CARD 5 -->
                <div class="col-12 col-sm-5 col-md-4 col-lg-4 mb-4">
                    <div class="card shadow bg-white rounded-3 clickable-card menu-card d-flex h-100">
                        <div class="card-body d-flex flex-row flex-sm-column h-100 p-2 p-sm-3">
                            <div class="me-3 me-sm-0 mb-sm-3">
                                <img src="images/beefstack.jpg" alt="Beefstack" class="rounded-3 card-img-responsive">
                            </div>
                            <div class="d-flex flex-column flex-grow-1 text-start text-sm-center">
                                <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-sm-center mt-sm-3">
                                    <h5 class="card-title mb-0">Beefstack</h5>
                                    <p class="card-text text-primary fw-bold mb-0">250.000đ</p>
                                </div>
                                <div class="small text-muted pt-2 text-start text-sm-center d-none d-sm-block">Bò miếng, quế, tiêu</div>
                                <div class="d-flex justify-content-between align-items-center mt-auto pt-3">
                                    <i class="bi bi-star-fill me-2" style="color: #1d7de2;"> 5</i>
                                    <button data-product-id="5" type="button" class="btn btn-primary">Thêm món</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div> <!-- Hết row -->
        </div>
    </div>

    <!-- CỘT PHẢI: GIỎ HÀNG -->
    <div class="offcanvas-lg offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
        <div class="offcanvas-header d-lg-none">
            <h5 class="offcanvas-title" id="cartOffcanvasLabel">Giỏ hàng</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#cartOffcanvas"></button>
        </div>

        <div class="offcanvas-body p-0 d-flex flex-column">
            <div class="cart-items-list p-3">
                <h5 class="text-center d-none d-md-block">Giỏ hàng</h5>
                <hr class="d-none d-md-block">
                <div id="cart-items">
                    <div class="add_food" food-id="1">
                        <div class="shadow bg-white rounded-3 clickable-card menu-card d-flex h-100">
                                <div class="card-body d-flex flex-row h-100 p-2 p-sm-3">
                                    <div class="me-3">
                                        <img src="images/cuahap.jpg" alt="Cua hấp" class="rounded-3 card-img-responsive" style="width: 70px; height: 70px; object-fit: cover;">
                                    </div>
                                    <div class="d-flex flex-column flex-grow-1 text-start">
                                        <div class="d-flex flex-column justify-content-between align-items-start mt-3 w-100">
                                            <div class="d-flex justify-content-between w-100">
                                                <div class="row">
                                                <h5 class="card-title mb-0">Cua hấp</h5>
                                                <p class="card-text text-primary fw-bold mb-0">90.000đ</p>
                                                </div>
                                                <div class="row">
                                                    <div class="input-group input-group-sm mt-2" style="width: 100px;">
                                                    <button class="btn btn-primary btn-decrease" type="button">-</button>
                                                    <input type="text" class="form-control text-center quantity-input" value="1">
                                                    <button class="btn btn-primary btn-increase" type="button">+</button>
                                                </div>
                                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div>

            <div class="cart-checkout p-3 bg-white">
                <div class="d-flex justify-content-between">
                    <strong class="fs-5">Tổng:</strong>
                    <strong id="cart-total" class="fs-5 text-primary">0đ</strong>
                </div>
                <button class="btn btn-primary w-100 mt-3">Thanh toán</button>
            </div>
        </div>
    </div>

    <!-- NÚT MỞ GIỎ HÀNG (MOBILE + TABLET) -->
    <button class="btn btn-primary rounded-circle mobile-cart-trigger" type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas">
        <i class="bi bi-cart-fill fs-4"></i>
    </button>

</div>
<script>
    const state = {
    products: [ /* ... danh sách món của fen ... */ ],
    cart: [] // Giỏ hàng ban đầu rỗng
};
const addToCartLogic = function(productId) {
    // A. Tìm xem món này là món nào trong kho (Products)
    // Lưu ý: data-id từ DOM luôn là String, phải ép kiểu về Number nếu id trong kho là Number
    const product = state.products.find(p => p.id === Number(productId));

    // B. Kiểm tra xem món này ĐÃ CÓ trong giỏ chưa?
    const existingItem = state.cart.find(item => item.id === product.id);

    if (existingItem) {
        // TRƯỜNG HỢP 1: Có rồi -> Tăng số lượng
        existingItem.quantity++;
    } else {
        // TRƯỜNG HỢP 2: Chưa có -> Thêm mới vào mảng cart
        // Fen nhớ copy object ra và thêm dòng quantity: 1
        state.cart.push({ ...product, quantity: 1 });   
    }

    // C. Gọi hàm render lại giao diện (View)
    console.log("Giỏ hàng hiện tại:", state.cart); // Log ra check trước
    // view.renderCart(state.cart); // Hàm vẽ HTML giỏ hàng fen tự viết nhé
};  
// --- 2. CONTROLLER (Lắng nghe sự kiện) ---
const container = document.querySelector('.product-container'); // Container bao quanh tất cả các card

container.addEventListener('click', function(e) {
    // Dùng Delegation: Tìm cái nút .btn-add gần nhất
    const btn = e.target.closest('.btn-add');

    // Guard Clause: Nếu click ra ngoài nút (ví dụ click vào ảnh, vào text) -> Bỏ qua
    if (!btn) return;

    // Lấy ID từ cái nút vừa bấm
    const id = btn.dataset.id;
    
    // Gọi Logic thêm
    addToCartLogic(id);
});
</script>>